(function(){var extend=function(t,e){function r(){this.constructor=t}for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;!function(t,e){"function"==typeof define&&define.amd?define(["yess","lodash"],function(r){return t.PropertyAccessors=e(t,r)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t,require("yess"),require("lodash")):t.PropertyAccessors=e(t,t._)}(this,function(__root__,_){var AbstractProperty,ArgumentError,BaseError,InstanceProperty,InvalidPropertyError,InvalidTargetError,PrototypeProperty,ReadonlyPropertyError,comparator,defineProperty,dependenciesToEvents,identityObject,prefixErrorMessage;return AbstractProperty=function(){function AbstractProperty(){}var defineProperty,hasOwnProperty;return defineProperty=Object.defineProperty,hasOwnProperty=Object.prototype.hasOwnProperty,AbstractProperty.prototype.define=function(){return defineProperty(this.target,this.property,{get:this.publicGetter(),set:this.publicSetter(),enumerable:!0,configurable:!0}),this.options.silent?defineProperty(this.target,"_"+this.property,{get:void 0,set:void 0,enumerable:!1,configurable:!0}):(defineProperty(this.target,"_"+this.property,{get:this.shadowGetter(),set:this.shadowSetter(),enumerable:!1,configurable:!0}),hasOwnProperty.call(this.target,"__"+this.property)||defineProperty(this.target,"__"+this.property,{enumerable:!1,writable:!0,configurable:!1})),"function"==typeof this.configureDependencies&&this.configureDependencies(),this},AbstractProperty.prototype.publicGetter=function(){var call,computer;return this.getter?this.options.memo?(computer=this.getter,call="string"==typeof this.getter?' this["'+this.getter+'"]() ':" computer.call(this) ",eval(' function fn() {\n  if (null == this["_'+this.property+'"]) { this["_'+this.property+'"] = '+call+'; }\n  return this["_'+this.property+'"];\n}'),fn):"string"==typeof this.getter?(eval(' function fn() { return this["'+this.getter+'"](); } '),fn):this.getter:(eval(' function fn() { return this["_'+this.property+'"]; } '),fn)},AbstractProperty.prototype.publicSetter=function(){return this.options.readonly?(eval(' function fn() { throw new ReadonlyPropertyError(this, "'+this.property+'"); } '),fn):this.setter?"string"==typeof this.setter?(eval(' function fn(value) { this["'+this.setter+'"](value); } '),fn):this.setter:(eval(' function fn(value) { this["_'+this.property+'"] = value; } '),fn)},AbstractProperty.prototype.shadowGetter=function(){return eval(' function fn() { return this["__'+this.property+'"]; } '),fn},AbstractProperty.prototype.shadowSetter=function(){var equal;return equal=comparator,eval(' function fn(x1) {\n  var x0 = this["__'+this.property+'"];\n  if (!equal(x1, x0)) {\n    this["__'+this.property+'"] = x1;\n    this.notify("change:'+this.property+'", this, x1, x0);\n  }\n}'),fn},AbstractProperty}(),PrototypeProperty=function(superClass){function PrototypeProperty(t,e,r,n,o){this.Class=t,this.property=e,this.getter=r,this.setter=n,this.options=o,PrototypeProperty.__super__.constructor.apply(this,arguments),this.prototype=this.Class.prototype,this.target=this.prototype,this.initializerKey="properties:events:"+this.property}return extend(PrototypeProperty,superClass),PrototypeProperty.prototype.configureDependencies=function(){var ref;return this.Class.deleteInitializer(this.initializerKey),this.getter&&!this.options.silent&&(null!=(ref=this.options.dependencies)?ref.length:void 0)>0?(eval('function fn() {\n  this.on("'+dependenciesToEvents(this.options.dependencies)+'", function() {\n    this["__'+this.property+'"] = null;\n    this["'+this.property+'"];\n  });\n}'),this.Class.initializer(this.initializerKey,fn)):void 0},PrototypeProperty}(AbstractProperty),InstanceProperty=function(superClass){function InstanceProperty(t,e,r,n,o){this.object=t,this.property=e,this.getter=r,this.setter=n,this.options=o,InstanceProperty.__super__.constructor.apply(this,arguments),this.target=this.object,this.callbackKey=this.property+"Callback"}return extend(InstanceProperty,superClass),InstanceProperty.prototype.configureDependencies=function(){var ref;return this.target[this.callbackKey]&&(this.object.off(null,this.target[this.callbackKey]),delete this.target[this.callbackKey]),this.getter&&!this.options.silent&&(null!=(ref=this.options.dependencies)?ref.length:void 0)>0?(eval(' function fn() {\n  this["__'+this.property+'"] = null;\n  this["'+this.property+'"];\n}'),this.target[this.callbackKey]=fn,this.object.on(dependenciesToEvents(this.options.dependencies),fn)):void 0},InstanceProperty}(AbstractProperty),comparator=function(t){var e,r;return r=t.wasConstructed,e=t.isEqual,function(t,n){return r(t)?t===n:e(t,n)}}(_),dependenciesToEvents=function(t){var e;return e=t.map,function(t){return e(t,function(t){return"change:"+t}).join(" ")}}(_),identityObject=function(t){var e;return e=t.wasConstructed,function(t){return(e(t)?t.constructor.name||t:t).toString()}}(_),prefixErrorMessage=function(t){return"[Properties] "+t},BaseError=function(t){function e(){e.__super__.constructor.call(this,this.message),("function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.name):void 0)||(this.stack=(new Error).stack)}return extend(e,t),e}(Error),ArgumentError=function(t){function e(t){this.name="ArgumentError",this.message=prefixErrorMessage(t),e.__super__.constructor.apply(this,arguments)}return extend(e,t),e}(BaseError),InvalidTargetError=function(t){function e(){this.name="InvalidTargetError",this.message=prefixErrorMessage("Can't define property on null or undefined"),e.__super__.constructor.apply(this,arguments)}return extend(e,t),e}(BaseError),InvalidPropertyError=function(t){function e(t){this.name="InvalidPropertyError",this.message=prefixErrorMessage("Invalid property name: '"+t+"'"),e.__super__.constructor.apply(this,arguments)}return extend(e,t),e}(BaseError),ReadonlyPropertyError=function(t){function e(t,r){this.name="ReadonlyPropertyError",this.message=prefixErrorMessage("Property "+identityObject(t)+"#"+r+" is readonly"),e.__super__.constructor.apply(this,arguments)}return extend(e,t),e}(BaseError),defineProperty=function(t){var e,r,n,o,i;return n=t.isFunction,i=t.isString,r=t.isClass,o=t.isObject,e=function(t){return i(t)||n(t)},function(t,n,s,p){var a,c,u,h,f,y,l;if(null==t)throw new InvalidTargetError;if(!i(n))throw new InvalidPropertyError(n);switch(u=!1,f=!1,arguments.length){case 2:break;case 3:if(e(s))c=s;else{if(!o(s))throw new ArgumentError("Expected object but given "+s);c=s.get,y=s.set,u=s.memo,f=s.readonly,a=s.depends,l=s.silent}break;case 4:if(!o(s)||!e(p))throw new ArgumentError("Expected object and accessor (function or function name) but given "+s+" and "+p);u=s.memo,f=s.readonly,a=s.depends,l=s.silent,c=p;break;default:throw new ArgumentError("Too many arguments given")}return e(c)||(c=null),e(y)||(y=null),u=!!u,f=!!f,h={memo:u,readonly:f,dependencies:a,silent:l},r(t)?new PrototypeProperty(t,n,c,y,h).define():new InstanceProperty(t,n,c,y,h).define()}}(_),{define:defineProperty,ClassMembers:{property:function(t){var e,r;return e=t.every,r=t.isString,function(){var t,n,o,i,s,p;for(t=[],i=arguments.length,o=-1;++o<i;)t.push(arguments[o]);if(e(t,function(t){return r(t)}))for(n=0,s=t.length;s>n;n++)p=t[n],defineProperty(this,p);else t.unshift(this),defineProperty.apply(null,t)}}(_)}}})}).call(this);